# Monitoring deployed models with data collection and telemetry

The following types of data can be collected for monitoring purposes:

- Production model input data
- Model predictions based on production input data

Azure Machine Learning service will save all data in Azure blob storage (in the associated storage account that gets automatically provisioned when the service itself is provisioned). The path has the following template:

```
/modeldata/<subscriptionid>/<resourcegroup>/<workspace>/<webservice>/<model>/<version>/<identifier>/<year>/<month>/<day>/data.csv
```

Here is an example of a `data.csv` file generated by the data collection feature:

![Azure Machine Learning service data collection](./media/azureml-data-collection-blob.png)

## Enabling data collection

To enable data collection, you need to have the proper dependencies added to your scoring file. Once you have these in place, you can use the Azure portal to enable data collection for your production model:

![Enable production model data collection in Azure portal](./media/azureml-data-collection-enable.png)

## Querying and analyzing monitoring data

Since the collected data is made available in CSV format in blob storage, you can use any tool to query and analyze the data. Some of the most popular options are [Power BI](https://powerbi.microsoft.com/desktop/) and [Azure Databricks](https://azure.microsoft.com/services/databricks/).

## Enabling Application Insights integration

Azure Machine Learning is integrated with [Azure Application Insights](https://docs.microsoft.com/azure/azure-monitor/app/app-insights-overview).

The official definition of Azure Application Insights is:

> _Application Insights is an extensible Application Performance Management (APM) service for web developers on multiple platforms. Use it to monitor your live web application. It will automatically detect performance anomalies. It includes powerful analytics tools to help you diagnose issues and to understand what users actually do with your app. It's designed to help you continuously improve performance and usability. It works for apps on a wide variety of platforms including .NET, Node.js and Java EE, hosted on-premises, hybrid, or any public cloud. It integrates with your DevOps process, and has connection points to a variety of development tools. It can monitor and analyze telemetry from mobile apps by integrating with Visual Studio App Center._

Enabling Application Insights telemetry on your production model provides the following benefits:

- Accurate measurement of request rates, response times, and failure rates
- Traceability for all usage
- History of exceptions

You can use the Azure portal to enable Application Insights integration for a model that has been published in production:

![Enable Application Insights integration in Azure Machine Learning](./media/azureml-telemetry-enable.png)

Deploying a trained model to production is described in the [Overview of deployment target options](../model-deployment/deployment-target-options.md) section.

Enabling data collection using the SDK is described in the [Monitoring a deployed model's collected data and telemetry (Code Sample)](./monitoring-data-and-telemetry-code-sample.md) section.

## Querying and analyzing monitoring data

You can use the Azure Portal to view and analyze the telemetry data collected by Application Insights:

![View Application Insights telemetry data in Azure Portal](./media/azureml-telemetry-azure-portal.png)

If you prefer to use Power BI to analyze telemetry data, you can do this using one of the following approaches:

- [Export Analytics queries](https://docs.microsoft.com/azure/azure-monitor/app/export-power-bi#export-analytics-queries)
- [Continuous export and Azure Stream Analytics](https://docs.microsoft.com/azure/azure-monitor/app/export-stream-analytics)